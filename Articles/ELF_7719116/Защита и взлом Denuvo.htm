<!DOCTYPE html>
<html lang="ru-RU"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v20.11 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Защита и взлом Denuvo</title>
	<meta name="description" content="Я уже писал о том, как я однажды разреверсил SecuROM, взломав защиту в пух и прах. Сегодня я покажу, как проделал то же с Denuvo. Взлом Denuvo. Взлом защиты Denuvo">
	<link rel="canonical" href="https://tech-geek.ru/cracking-denuvo/">
	<meta property="og:locale" content="ru_RU">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Защита и взлом Denuvo">
	<meta property="og:description" content="Я уже писал о том, как я однажды разреверсил SecuROM, взломав защиту в пух и прах. Сегодня я покажу, как проделал то же с Denuvo. Взлом Denuvo. Взлом защиты Denuvo">
	<meta property="og:url" content="https://tech-geek.ru/cracking-denuvo/">
	<meta property="og:site_name" content="TECH GEEK">
	<meta property="article:published_time" content="2019-04-19T12:44:59+00:00">
	<meta property="article:modified_time" content="2019-10-08T20:41:18+00:00">
	<meta property="og:image" content="https://tech-geek.ru/wp-content/uploads/cracking-denuvo.png">
	<meta property="og:image:width" content="770">
	<meta property="og:image:height" content="330">
	<meta property="og:image:type" content="image/png">
	<meta name="author" content="Unkn0wn">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:creator" content="@htechgeekru1">
	<meta name="twitter:site" content="@htechgeekru1">
	<meta name="twitter:label1" content="Написано автором">
	<meta name="twitter:data1" content="Unkn0wn">
	<meta name="twitter:label2" content="Примерное время для чтения">
	<meta name="twitter:data2" content="7 минут">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://tech-geek.ru/cracking-denuvo/#article","isPartOf":{"@id":"https://tech-geek.ru/cracking-denuvo/"},"author":{"name":"Unkn0wn","@id":"https://tech-geek.ru/#/schema/person/269be273a446046ca6cae18401cb2c34"},"headline":"Взлом защиты Denuvo","datePublished":"2019-04-19T12:44:59+00:00","dateModified":"2019-10-08T20:41:18+00:00","mainEntityOfPage":{"@id":"https://tech-geek.ru/cracking-denuvo/"},"wordCount":3204,"commentCount":1,"publisher":{"@id":"https://tech-geek.ru/#organization"},"image":{"@id":"https://tech-geek.ru/cracking-denuvo/#primaryimage"},"thumbnailUrl":"https://tech-geek.ru/wp-content/uploads/cracking-denuvo.png","articleSection":["Игры"],"inLanguage":"ru-RU","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://tech-geek.ru/cracking-denuvo/#respond"]}]},{"@type":"WebPage","@id":"https://tech-geek.ru/cracking-denuvo/","url":"https://tech-geek.ru/cracking-denuvo/","name":"Защита и взлом Denuvo","isPartOf":{"@id":"https://tech-geek.ru/#website"},"primaryImageOfPage":{"@id":"https://tech-geek.ru/cracking-denuvo/#primaryimage"},"image":{"@id":"https://tech-geek.ru/cracking-denuvo/#primaryimage"},"thumbnailUrl":"https://tech-geek.ru/wp-content/uploads/cracking-denuvo.png","datePublished":"2019-04-19T12:44:59+00:00","dateModified":"2019-10-08T20:41:18+00:00","description":"Я уже писал о том, как я однажды разреверсил SecuROM, взломав защиту в пух и прах. Сегодня я покажу, как проделал то же с Denuvo. Взлом Denuvo. Взлом защиты Denuvo","breadcrumb":{"@id":"https://tech-geek.ru/cracking-denuvo/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://tech-geek.ru/cracking-denuvo/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://tech-geek.ru/cracking-denuvo/#primaryimage","url":"https://tech-geek.ru/wp-content/uploads/cracking-denuvo.png","contentUrl":"https://tech-geek.ru/wp-content/uploads/cracking-denuvo.png","width":770,"height":330,"caption":"Защита взлом Denuvo"},{"@type":"BreadcrumbList","@id":"https://tech-geek.ru/cracking-denuvo/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://tech-geek.ru/"},{"@type":"ListItem","position":2,"name":"Взлом защиты Denuvo"}]},{"@type":"WebSite","@id":"https://tech-geek.ru/#website","url":"https://tech-geek.ru/","name":"TECH GEEK","description":"О компьютерах и не только","publisher":{"@id":"https://tech-geek.ru/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://tech-geek.ru/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"ru-RU"},{"@type":"Organization","@id":"https://tech-geek.ru/#organization","name":"TECH-GEEK.RU","url":"https://tech-geek.ru/","logo":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://tech-geek.ru/#/schema/logo/image/","url":"https://tech-geek.ru/wp-content/uploads/Tech-Geek.ru_.png","contentUrl":"https://tech-geek.ru/wp-content/uploads/Tech-Geek.ru_.png","width":"512","height":"512","caption":"TECH-GEEK.RU"},"image":{"@id":"https://tech-geek.ru/#/schema/logo/image/"},"sameAs":["https://twitter.com/htechgeekru1"]},{"@type":"Person","@id":"https://tech-geek.ru/#/schema/person/269be273a446046ca6cae18401cb2c34","name":"Unkn0wn","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://tech-geek.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/225ba35955d741076724056aa05a8644?s=96&d=retro&r=g","contentUrl":"https://secure.gravatar.com/avatar/225ba35955d741076724056aa05a8644?s=96&d=retro&r=g","caption":"Unkn0wn"},"description":"Хакер, «языковед», функциональщик, иногда сетевой администратор."}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/tech-geek.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.3"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="crayon-theme-idle-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/idle.css" media="all">
<link rel="stylesheet" id="crayon-font-courier-new-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/courier-new.css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/style.min_002.css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="wp-postratings-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/postratings-css.css" media="all">
<link rel="stylesheet" id="google-fonts-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/css.css" media="all">
<link rel="stylesheet" id="root-style-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/style.min.css" media="all">
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/jquery.min.js" id="jquery-core-js"></script>
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://tech-geek.ru/wp-json/"><link rel="alternate" type="application/json" href="https://tech-geek.ru/wp-json/wp/v2/posts/7994"><link rel="alternate" type="application/json+oembed" href="https://tech-geek.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ftech-geek.ru%2Fcracking-denuvo%2F">
<link rel="alternate" type="text/xml+oembed" href="https://tech-geek.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ftech-geek.ru%2Fcracking-denuvo%2F&amp;format=xml">
<style>.site-logotype {max-width:1000px}.site-logotype img {max-height:100px}.scrolltop {background-color:#cccccc}.scrolltop:after {color:#ffffff}.scrolltop {width:40px}.scrolltop {height:40px}.scrolltop:after {content:"\f102"}.entry-image:not(.entry-image--big) {margin-left:-20px}@media (min-width: 1200px) {.entry-image:not(.entry-image--big) {margin-left:-40px} }.b-related .post-card__image, .b-related .post-card__image img, .b-related .post-card__image .entry-meta, .b-related .thumb-wide {border-radius:6px}body {font-family:"Roboto" ,"Helvetica Neue", Helvetica, Arial, sans-serif}@media (min-width: 576px) {body {font-size:16px} }@media (min-width: 576px) {body {line-height:1.5} }.site-title, .site-title a {font-family:"Roboto" ,"Helvetica Neue", Helvetica, Arial, sans-serif}@media (min-width: 576px) {.site-title, .site-title a {font-size:28px} }@media (min-width: 576px) {.site-title, .site-title a {line-height:1.1} }.site-description {font-family:"Roboto" ,"Helvetica Neue", Helvetica, Arial, sans-serif}@media (min-width: 576px) {.site-description {font-size:16px} }@media (min-width: 576px) {.site-description {line-height:1.5} }.main-navigation ul li a, .main-navigation ul li .removed-link, .footer-navigation ul li a, .footer-navigation ul li .removed-link{font-family:"Roboto" ,"Helvetica Neue", Helvetica, Arial, sans-serif}@media (min-width: 576px) {.main-navigation ul li a, .main-navigation ul li .removed-link, .footer-navigation ul li a, .footer-navigation ul li .removed-link {font-size: 16px} }@media (min-width: 576px) {.main-navigation ul li a, .main-navigation ul li .removed-link, .footer-navigation ul li a, .footer-navigation ul li .removed-link {line-height:1.5} }.h1, h1:not(.site-title) {font-weight:bold;}.h2, h2 {font-weight:bold;}.h3, h3 {font-weight:bold;}.h4, h4 {font-weight:bold;}.h5, h5 {font-weight:bold;}.h6, h6 {font-weight:bold;}.mob-hamburger span, .card-slider__category, .card-slider-container .swiper-pagination-bullet-active, .page-separator, .pagination .current, .pagination a.page-numbers:hover, .entry-content ul > li:before, .entry-content ul:not([class])>li:before, .taxonomy-description ul:not([class])>li:before, .btn, .comment-respond .form-submit input, .contact-form .contact_submit, .page-links__item {background-color:#969696}.spoiler-box, .entry-content ol li:before, .entry-content ol:not([class]) li:before, .taxonomy-description ol:not([class]) li:before, .mob-hamburger, .inp:focus, .search-form__text:focus, .entry-content blockquote,
         .comment-respond .comment-form-author input:focus, .comment-respond .comment-form-author textarea:focus, .comment-respond .comment-form-comment input:focus, .comment-respond .comment-form-comment textarea:focus, .comment-respond .comment-form-email input:focus, .comment-respond .comment-form-email textarea:focus, .comment-respond .comment-form-url input:focus, .comment-respond .comment-form-url textarea:focus {border-color:#969696}.entry-content blockquote:before, .spoiler-box__title:after, .sidebar-navigation .menu-item-has-children:after,
        .star-rating--score-1:not(.hover) .star-rating-item:nth-child(1),
        .star-rating--score-2:not(.hover) .star-rating-item:nth-child(1), .star-rating--score-2:not(.hover) .star-rating-item:nth-child(2),
        .star-rating--score-3:not(.hover) .star-rating-item:nth-child(1), .star-rating--score-3:not(.hover) .star-rating-item:nth-child(2), .star-rating--score-3:not(.hover) .star-rating-item:nth-child(3),
        .star-rating--score-4:not(.hover) .star-rating-item:nth-child(1), .star-rating--score-4:not(.hover) .star-rating-item:nth-child(2), .star-rating--score-4:not(.hover) .star-rating-item:nth-child(3), .star-rating--score-4:not(.hover) .star-rating-item:nth-child(4),
        .star-rating--score-5:not(.hover) .star-rating-item:nth-child(1), .star-rating--score-5:not(.hover) .star-rating-item:nth-child(2), .star-rating--score-5:not(.hover) .star-rating-item:nth-child(3), .star-rating--score-5:not(.hover) .star-rating-item:nth-child(4), .star-rating--score-5:not(.hover) .star-rating-item:nth-child(5), .star-rating-item.hover {color:#969696}body {color:#333333}a, .spanlink, .comment-reply-link, .pseudo-link, .root-pseudo-link {color:#428bca}a:hover, a:focus, a:active, .spanlink:hover, .comment-reply-link:hover, .pseudo-link:hover {color:#e66212}.site-header {background-color:#ffffff}.site-header {color:#333333}.site-title, .site-title a {color:#606060}.site-description, .site-description a {color:#666666}.main-navigation, .footer-navigation, .main-navigation ul li .sub-menu, .footer-navigation ul li .sub-menu {background-color:#f6f7fb}.main-navigation ul li a, .main-navigation ul li .removed-link, .footer-navigation ul li a, .footer-navigation ul li .removed-link {color:#020202}.site-content {background-color:#ffffff}.site-footer {background-color:#ffffff}.site-footer {color:#333333}</style><link rel="preload" href="https://tech-geek.ru/wp-content/themes/root/fonts/fontawesome-webfont.ttf" as="font" crossorigin=""><link rel="preload" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo.png" as="image" crossorigin=""><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #efeff4; }
</style>
	<link rel="icon" href="https://tech-geek.ru/wp-content/uploads/cropped-Tech-Geek.ru_-32x32.png" sizes="32x32">
<link rel="icon" href="https://tech-geek.ru/wp-content/uploads/cropped-Tech-Geek.ru_-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://tech-geek.ru/wp-content/uploads/cropped-Tech-Geek.ru_-180x180.png">
<meta name="msapplication-TileImage" content="https://tech-geek.ru/wp-content/uploads/cropped-Tech-Geek.ru_-270x270.png">
		<style type="text/css" id="wp-custom-css">
			@media (min-width: 1200px) {
.content-area {
width: 770px;
}
}

@media (min-width:768px) {
 .entry-content {
  padding-left:0px;
 }
}
.entry-content blockquote
.entry-content blockquote.warning, .entry-content blockquote.info, 
.entry-content blockquote.danger, .entry-content blockquote.check, 
.entry-content blockquote.quote 
{
	margin-left: -40px;
  margin-right: 5px;}

@media (min-width:1200px) {
 .entry-content blockquote,
 .taxonomy-description blockquote {
  margin-left:-40px;
 }
}

@media (min-width:768px) {
 .table-of-contents {
	background:#f6f7fb61;
  margin-left:-40px;
 }
}

.entry-content blockquote.info:before {
    content: "\f05a";
}		</style>
		    <script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/wp-emoji-release.min.js" defer="defer"></script><script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/wp-emoji-release.min_002.js" defer="defer"></script></head>

<body class="post-template-default single single-post postid-7994 single-format-standard custom-background  group-blog">



<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#main">Перейти к контенту</a>

    
    
<!-- #masthead -->
    
    
    
    <nav id="site-navigation" class="main-navigation container" itemscope="" itemtype="http://schema.org/SiteNavigationElement">
        <!--.main-navigation-inner-->
    </nav><!-- #site-navigation -->

    

    
    
	<div id="content" class="site-content container">

        

<div itemscope="" itemtype="http://schema.org/Article">

    
	<div id="primary" class="content-area">
		<main id="main" class="site-main">

            
			
<article id="post-7994" class="post-7994 post type-post status-publish format-standard has-post-thumbnail  category-games">

    
        <header class="entry-header">
                                            <h1 class="entry-title" itemprop="headline">Взлом защиты Denuvo</h1>                            
            
                            <div class="entry-meta"><span class="entry-author"><span class="hidden-xs">Автор:</span> <span itemprop="author">elf</span></span></div><!-- .entry-meta -->                    </header><!-- .entry-header -->


                    <div class="entry-image">
                <img width="770" height="330" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo.png" class="attachment-full size-full wp-post-image" alt="Защита взлом Denuvo" decoding="async" itemprop="image" fetchpriority="high" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo.png 770w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-768x329.png 768w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-330x140.png 330w" sizes="(max-width: 770px) 100vw, 770px">            </div>
        
    
	<div class="entry-content" itemprop="articleBody">
		<p>В 2014 году появилась защита от пиратства, которая позже станет 
одной из самых узнаваемых, — Denuvo. Она пришла на смену SecuROM и 
связана с одним действующим лицом — Рейнгардом Блауковичем. Пару лет 
назад я уже писал о том, как я однажды разреверсил SecuROM, разгромив 
защиту Блауковича в пух и прах. Сегодня я покажу, как проделал то же с 
Denuvo. Встречайте новую серию «Тибериумного реверсинга»!</p><div class="b-r b-r--after-p"><script async="" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/adsbygoogle.js"></script>
<!-- techgeekru above adaptive -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5859973253765166" data-ad-slot="4616733177" data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<blockquote class="info"><p>Публикуется в память о Крисе Касперски и в поддержку Voksi.</p></blockquote>
<div class="table-of-contents open"><!--noindex--><div class="table-of-contents__header"><span class="table-of-contents__hide js-table-of-contents-hide">Содержание</span></div><ol class="table-of-contents__list js-table-of-contents-list">
<li class="level-1"><a href="#vzlom-zaschity-denuvo">Взлом защиты Denuvo</a></li><li class="level-1"><a href="#ea-drm-oep-dump">EA DRM, OEP, dump</a></li><li class="level-1"><a href="#ea-origin-sdk-give-me-the-handle-and-i-ll">EA Origin SDK: Give me the handle and I’ll crack this!</a></li><li class="level-1"><a href="#layfhaki-dlya-dalneyshego-kovyryaniya-denuvo">Лайфхаки для дальнейшего ковыряния Denuvo</a></li><li class="level-1"><a href="#deobfuskatsiya-eah">Деобфускация EAH</a></li><li class="level-1"><a href="#denuvo-vmprotect-love">Denuvo + VMProtect = love</a></li><li class="level-1"><a href="#denuvo-keygen-or-not">Denuvo keygen or not</a></li></ol><!--/noindex--></div><h2 id="vzlom-zaschity-denuvo">Взлом защиты Denuvo</h2>
<p>Да, эту статью можно было написать и раньше, но в жизни много других 
важных вещей. Работа в лаборатории, перемещения, моя муза и ее красный 
Ford Focus II за окном. На его капоте мирно таял свежий снег, когда 
начинался 2019 год. Мне же в голову начали лезть мысли о корпорации 
Electronic Arts, магазине Origin, игрушках Unravel и Battlefield 4, 
реализации EA DRM, Denuvo, VMProtect, и… все завертелось.</p>
<p>Если по Steam в Google можно наяндексить все что угодно — от кастомок
 до эмуляторов, то в связи с клиентом Origin вспоминается разве что 
динамическая библиотека 
			<span id="crayon-64eccedc18328824327262" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">ItsAMe_Origin</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span>,
 которая вместо оригинала сама сабмитит запросы от клиента. Собственно, 
100% пабликовых взломов Origin (3DM, CPY и другие) именно так и 
работают.</p>
<p>Прямо здесь начинается первый секрет: для взлома Origin вовсе не 
обязательно копировать систему ответов-запросов «клиент-сервер» (чаще 
всего это около десяти уникальных ID сообщений)! Потребуется чуть-чуть 
пореверсить клиент и поближе познакомиться с таким термином, как EA 
handle (далее — EAH). Но обо всем по порядку.</p>
<p>За рекламирование всякой ерунды, непомерные требования к ресурсам и 
вытекающую отсюда слоупочность официальный пакет Origin не ругает только
 ленивый, но мы пойдем дальше и покажем его уязвимую суть. На момент 
написания статьи вышла версия 10.5.31, а разбирать мы будем клиент 
9.10.1.7. Принципиальной разницы между ними нет — EAH и там и там 
одинаков.</p>
<p>На наше счастье, клиент Origin SDK (который запихивается в саму 
игрушку) имеет много ошибок — как мелких, так и весьма серьезных. 
Например, при его работе остаются открытые хендлы объектов, для которых 
SDK почему-то забывает вызывать функции WinAPI 
			<span id="crayon-64eccedc18330418934253" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">RegCloseKey</span></span></span> и 
			<span id="crayon-64eccedc18332093660285" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">CloseHandle</span></span></span>. На это можно было бы закрыть глаза, но вот на вызов адреса с нулевым указателем можно смело сабмитить багрепорты.</p>
<p>Думаю, виной тому откровенная запутанность EAH: перегруженность 
критическими секциями и семафорами, а также фирменная рекурсия 
указателей на данные. В такой суматохе запросто можно забыть освободить 
выделенный блок памяти. Благо процедура уничтожения EAH срабатывает при 
выходе из игрушки (читай — вызове функции 
			<span id="crayon-64eccedc18334609784275" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">TerminateProcess</span></span></span>), что, по мнению буржуйских разработчиков, автоматом избавляет их от этой проблемы.</p>
<blockquote class="check"><p>РЕКОМЕНДУЕМ:<br>
<a href="https://tech-geek.ru/make-cheat-codes-for-games/" rel="bookmark" data-wpel-link="internal">Как писать читы для игр</a></p></blockquote>
<p>Вот теперь минутка лулзов, леди и джентльмены! Сказ о том, как Denuvo
 Software Solution навешивала anti-tamper уже на саму Origin SDK. Делали
 они это весьма неумело, так как не курили мануалов и не представляют, 
что именно требуется защитить от посягательства пиратов. Всю мякотку я 
вынес в отдельную часть статьи.</p>
<p>К сожалению, в отличие от SecuROM в код Denuvo Блаукович не вставлял 
анекдотов. Однако если следовать традиции, то здесь была бы уместна 
история про ковбоя, который на спор обмочил весь бар, но ни разу не 
попал в бутылку.</p>
<p>Вот что делает защита Origin SDK:</p>
<ul>
<li>выполняет виртуализацию функции 
			<span id="crayon-64eccedc18335649468460" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">MD5_Update</span></span></span> в процедуре отправки запроса;</li>
<li>использует константы Origin и игрушки для вставки инструкций cpuid/ret;</li>
<li>для отдельных указателей ret (return С++) в процедурах SDK выполняет переход в динамику с дальнейшей обфускацией Denuvo.</li>
</ul>
<p>Зачем все это? Зачем ей все шелка, цветные облака… зачем?! У нас ведь
 есть EAH и целая функция инициализации Origin SDK, о которой Denuvo 
почему-то не знает.</p>
<figure id="attachment_8000" aria-describedby="caption-attachment-8000" style="width: 900px" class="wp-caption aligncenter"><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-1.jpg" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" class="size-full wp-image-8000" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-1.jpg" alt="взлом denuvo" width="900" height="277" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-1.jpg 900w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-1-768x236.jpg 768w" sizes="(max-width: 900px) 100vw, 900px"><meta itemprop="width" content="900"><meta itemprop="height" content="277"></span></a><figcaption id="caption-attachment-8000" class="wp-caption-text">Виталий Кличко устроился работать в Electronic Arts</figcaption></figure>
<p>Не отстают от Denuvo Software Solution и наши спортсмены-игроделы. 
Количество контекстов VMProtect достигло сорока для каноничной второй 
версии и десяти для третьей. Причем сначала они утрамбовали старую 
вторую, а сверху повесили третью для защиты целостности второй. Это 
примерно как если StarForce защищать при помощи SecuROM.</p>
<p>Признаться, в первый раз я несколько прифигел, когда автоматом накрыл
 все сорок контекстов VMP 2.x за один раз. Однако после проследования 
станции метро OEP (Original Entry Point), ближе к перегону загрузки 
kit-файлов игрушки Unravel (Unravel 
			<span id="crayon-64eccedc18337869624460" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">_dump_SCY_dump</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></span></span>) тулза 
			<span id="crayon-64eccedc18338062810006" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Denuvo_Profiler</span></span></span>
 собственной сборки начала сигнализировать о перезаписи патченных 
хендлов старого импорта каким-то сторонним кодом. For great justice — 
последние версии Denuvo так и защищали, что вывело новую породу 
гибридных протекторов.</p>
<figure id="attachment_8001" aria-describedby="caption-attachment-8001" style="width: 1010px" class="wp-caption aligncenter"><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-1.png" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" class="size-full wp-image-8001" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-1.png" alt="взлом denuvo" width="1010" height="1378" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-1.png 1010w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-1-768x1048.png 768w" sizes="(max-width: 1010px) 100vw, 1010px"><meta itemprop="width" content="1010"><meta itemprop="height" content="1378"></span></a><figcaption id="caption-attachment-8001" class="wp-caption-text">Denuvo_Profiler:
 именно этими данными формируется Denuvo HWID для вашей машины, плюс 
расшифровка файла лицензии EA Origin и последующее извлечение секретной 
таблицы Denuvo</figcaption></figure>
<h2 id="ea-drm-oep-dump">EA DRM, OEP, dump</h2>
<p>Первое, с чем придется столкнуться при взломе и отвязке игрушки от 
Origin, — это EA DRM. Опознать его легко по точке входа, которая 
катапультирует нас (jmp) в библиотеку 
			<span id="crayon-64eccedc1833a100132212" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Activation</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span> или 
			<span id="crayon-64eccedc1833b684138308" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Activation64</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span> — смотря какой разрядности винда. Вот как это выглядит у меня:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc1833c488770666" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc1833c488770666-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1833c488770666-2">2</div><div class="crayon-num" data-line="crayon-64eccedc1833c488770666-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1833c488770666-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc1833c488770666-1"><span class="crayon-sy">.</span><span class="crayon-i">ooa</span><span class="crayon-sy">:</span><span class="crayon-cn">0000000142D46000</span><span class="crayon-h"> </span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-i">start</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1833c488770666-2"><span class="crayon-sy">.</span><span class="crayon-i">ooa</span><span class="crayon-sy">:</span><span class="crayon-cn">0000000142D46000</span><span class="crayon-h"> </span><span class="crayon-i">start</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-64eccedc1833c488770666-3"><span class="crayon-sy">.</span><span class="crayon-i">ooa</span><span class="crayon-sy">:</span><span class="crayon-cn">0000000142D46000</span><span class="crayon-h"> </span><span class="crayon-i">nop</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1833c488770666-4"><span class="crayon-sy">.</span><span class="crayon-i">ooa</span><span class="crayon-sy">:</span><span class="crayon-cn">0000000142D46001</span><span class="crayon-h"> </span><span class="crayon-e">jmp </span><span class="crayon-i">cs</span><span class="crayon-sy">:</span><span class="crayon-i">Core_Activation64_100</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>При наличии купленной игрушки в библиотеке EA DRM снимается не 
сложнее, чем распаковывается UPX. Вся процедура сводится к тому, что SDK
 получает AES-ключик для расшифровки контента. Если ключ верный, то 
дальше SDK сам восстанавливает секции и делает импорт. Дальнейший 
переход в OEP защищаемой EA игрушки обычно выполняется ближе к концу 
вызываемой процедуры (в моем примере это 
			<span id="crayon-64eccedc1833e502299045" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">call </span><span class="crayon-i">r9</span></span></span> по адресу 000007FEF1687412), либо перед этим вызывается функция 
			<span id="crayon-64eccedc1833f992068210" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">GetModuleHandleW</span></span></span>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18340489371227" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -29px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18340489371227-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-6">6</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-8">8</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-10">10</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-12">12</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-14">14</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-16">16</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18340489371227-18">18</div><div class="crayon-num" data-line="crayon-64eccedc18340489371227-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18340489371227-1"><span class="crayon-cn">000007FEF16873E4</span><span class="crayon-h"> </span><span class="crayon-e">call </span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-h">&lt;</span><span class="crayon-h">&amp;GetModuleHandleW</span><span class="crayon-h">&gt;</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-2"><span class="crayon-cn">000007FEF16873EA</span><span class="crayon-h"> </span><span class="crayon-e">lea </span><span class="crayon-i">rcx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ss</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rbp</span>+<span class="crayon-cn">0x10</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-3"><span class="crayon-cn">000007FEF16873EE</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">rsi</span><span class="crayon-sy">,</span><span class="crayon-i">rax</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-4"><span class="crayon-cn">000007FEF16873F1</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">activation64_original</span><span class="crayon-sy">.</span><span class="crayon-i">Verify_and_GetModuleHalde</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-5"><span class="crayon-cn">000007FEF16873F6</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">rbx</span><span class="crayon-sy">,</span><span class="crayon-i">rax</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-6"><span class="crayon-cn">000007FEF16873F9</span><span class="crayon-h"> </span><span class="crayon-e">test </span><span class="crayon-i">rax</span><span class="crayon-sy">,</span><span class="crayon-i">rax</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-7"><span class="crayon-cn">000007FEF16873FC</span><span class="crayon-h"> </span><span class="crayon-e">je </span><span class="crayon-i">activation64_original</span><span class="crayon-sy">.</span><span class="crayon-cn">7FEF168741B</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-8"><span class="crayon-cn">000007FEF16873FE</span><span class="crayon-h"> </span><span class="crayon-i">nop</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-9"><span class="crayon-cn">000007FEF1687400</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">r9</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rbx</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-10"><span class="crayon-cn">000007FEF1687403</span><span class="crayon-h"> </span><span class="crayon-e">test </span><span class="crayon-i">r9</span><span class="crayon-sy">,</span><span class="crayon-i">r9</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-11"><span class="crayon-cn">000007FEF1687406</span><span class="crayon-h"> </span><span class="crayon-e">je </span><span class="crayon-i">activation64_original</span><span class="crayon-sy">.</span><span class="crayon-cn">7FEF168741B</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-12"><span class="crayon-cn">000007FEF1687408</span><span class="crayon-h"> </span><span class="crayon-st">xor</span><span class="crayon-h"> </span><span class="crayon-i">r8d</span><span class="crayon-sy">,</span><span class="crayon-i">r8d</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-13"><span class="crayon-cn">000007FEF168740B</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">rcx</span><span class="crayon-sy">,</span><span class="crayon-i">rsi</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-14"><span class="crayon-cn">000007FEF168740E</span><span class="crayon-h"> </span><span class="crayon-e">lea </span><span class="crayon-i">edx</span><span class="crayon-sy">,</span><span class="crayon-e">dword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">r8</span>+<span class="crayon-cn">0x1</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-15"><span class="crayon-cn">000007FEF1687412</span><span class="crayon-h"> </span><span class="crayon-e">call </span><span class="crayon-i">r9</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-16"><span class="crayon-cn">000007FEF1687415</span><span class="crayon-h"> </span><span class="crayon-e">add </span><span class="crayon-i">rbx</span><span class="crayon-sy">,</span><span class="crayon-cn">0x8</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-17"><span class="crayon-cn">000007FEF1687419</span><span class="crayon-h"> </span><span class="crayon-e">jne </span><span class="crayon-i">activation64_original</span><span class="crayon-sy">.</span><span class="crayon-cn">7FEF1687400</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18340489371227-18"><span class="crayon-cn">000007FEF168741B</span><span class="crayon-h"> </span><span class="crayon-e">call </span><span class="crayon-i">rdi</span></div><div class="crayon-line" id="crayon-64eccedc18340489371227-19"><span class="crayon-cn">000007FEF168741D</span><span class="crayon-h"> </span><span class="crayon-e">lea </span><span class="crayon-i">rcx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ss</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rbp</span>+<span class="crayon-cn">0x6A0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Здесь сложности могут возникнуть разве что при перехвате управления. Дело в том, что игрушку с определенным каналом (
			<span id="crayon-64eccedc18341449594490" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;">/<span class="crayon-i">SMOID</span>=<span class="crayon-h"> </span><span class="crayon-sy">%</span>хендл<span class="crayon-h"> </span>от<span class="crayon-h"> </span><span class="crayon-i">CreateFileMapping</span><span class="crayon-sy">%</span></span></span>) должен вызывать сам 
			<span id="crayon-64eccedc18344390311837" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Origin</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></span></span>, да еще иногда по нескольку раз. Пока мы будем аттачиться к процессу — пропустим момент выхода на OEP из 
			<span id="crayon-64eccedc18345461248031" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">Activation</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span>.</p>
<p>Лайфхак прост — сделать подмену библиотеки Activation(64).dll на свою
 с редиректом вызовов в оригинал. При подхвате управления выводим 
радостный 
			<span id="crayon-64eccedc18346470388307" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">MessageBox</span></span></span> и ожидаем аттача.</p>
<h2 id="ea-origin-sdk-give-me-the-handle-and-i-ll">EA Origin SDK: Give me the handle and I’ll crack this!</h2>
<p>Общая стратегия взлома Origin SDK (который инклудится в игрушку) 
имеет два разных сценария в зависимости от того, что ты хочешь получить в
 итоге. Первый вариант сложный, очень палевный и приватный. Он требуется
 для сетевых игр и обеспечивает возможность играть на официальных 
серверах. Через цепочку 
			<span id="crayon-64eccedc18347781892941" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">OriginGetDefaultUser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>—<span class="crayon-h"> </span><span class="crayon-e">OriginRequestAuthCode</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"имя сервера"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">ex</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">GOS</span>-<span class="crayon-i">BlazeServer</span>-<span class="crayon-i">BF4</span>-<span class="crayon-i">PC</span><span class="crayon-sy">)</span></span></span>, нужно получить код авторизации, а затем постучать этим AuthCode на сервер. Короче, это тема для отдельной статьи.</p>
<p>Второй вариант гораздо проще. Он пригоден для прохождения одиночных 
кампаний на локальном компе и никак тебя не запалит в сети. Его мы и 
рассмотрим подробнее.</p>
<p>Для начала отыщем в коде игрушки процедуру инициализации Origin SDK. 
Она получает от Origin.exe (в доках он часто называется OriginCore) 
данные о версии сервера, пользователе и другую подобную инфу, 
необходимую для дальнейшего запуска игрушки. Если же во время 
инициализации произойдет ошибка, то процесс попросту завершится, что не 
входит в наши планы.</p>
<p>Самое главное — эта подпрограмма создает EAH, а всю присланную инфу 
OriginSDK сливает в эту структуру. Обнаружить код инициализации Origin 
SDK можно по следующим признакам:</p>
<ul>
<li>использование функции 
			<span id="crayon-64eccedc18349825791359" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">getenv</span></span></span> из библиотеки 
			<span id="crayon-64eccedc1834a939086229" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">msvcr_xxx</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span> (рантайма);</li>
<li>появление строк 
			<span id="crayon-64eccedc1834b795758586" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">ContentId</span></span></span>, 
			<span id="crayon-64eccedc1834c392013869" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">EAConnectionId</span></span></span>, 
			<span id="crayon-64eccedc1834d901984015" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">OriginStartup </span><span class="crayon-i">entered</span></span></span>;</li>
<li>указание характерных констант ошибок Origin SDK, например 0xa0020008
 (ORIGIN_ERROR_CORE_NOT_INSTALLED) или 0xa0010000 
(ORIGIN_ERROR_SDK_NOT_INITIALIZED);</li>
<li>работа с «карточкой» игрушки. Это такая специальная структура, код которой приводится ниже:</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc1834f701066814" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc1834f701066814-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1834f701066814-2">2</div><div class="crayon-num" data-line="crayon-64eccedc1834f701066814-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1834f701066814-4">4</div><div class="crayon-num" data-line="crayon-64eccedc1834f701066814-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1834f701066814-6">6</div><div class="crayon-num" data-line="crayon-64eccedc1834f701066814-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1834f701066814-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc1834f701066814-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">struct_EA_ACCESS_request</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1834f701066814-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-64eccedc1834f701066814-3"><span class="crayon-t">char</span>*<span class="crayon-h"> </span><span class="crayon-i">ContentId</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// 1031469 (идентификатор контента)</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1834f701066814-4"><span class="crayon-t">char</span>*<span class="crayon-h"> </span><span class="crayon-i">Title</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Unravel (название игры)</span></div><div class="crayon-line" id="crayon-64eccedc1834f701066814-5"><span class="crayon-t">char</span>*<span class="crayon-h"> </span><span class="crayon-i">MultiplayerId</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// 1031469 (идентификатор пользователя для сетевой игры)</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1834f701066814-6"><span class="crayon-t">char</span>*<span class="crayon-h"> </span><span class="crayon-i">Language</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// en_US</span></div><div class="crayon-line" id="crayon-64eccedc1834f701066814-7"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1834f701066814-8"><span class="crayon-i">EA_ACCESS_request</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>*<span class="crayon-i">pEA_ACCESS_request</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Идентификационная карточка приложения</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>К примеру, в последней на момент написания статьи версии Battlefield 4
 (1.8.2.48475) вход в процедуру инициализации Origin SDK выглядел так:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18350656674655" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18350656674655-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18350656674655-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18350656674655-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18350656674655-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18350656674655-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18350656674655-6">6</div><div class="crayon-num" data-line="crayon-64eccedc18350656674655-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18350656674655-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18350656674655-1"><span class="crayon-cn">0000000140DDB59B</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">bf4_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">sub_140DDD1D0</span><span class="crayon-h">&gt;</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18350656674655-2"><span class="crayon-cn">0000000140DDB5A0</span><span class="crayon-h"> </span><span class="crayon-e">lea </span><span class="crayon-i">rcx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ss</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rsp</span>+<span class="crayon-cn">0x38</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-64eccedc18350656674655-3"><span class="crayon-cn">0000000140DDB5A5</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">bf4_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">origin_startup</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-c">// А вот и вход!</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18350656674655-4"><span class="crayon-cn">0000000140DDB5AA</span><span class="crayon-h"> </span><span class="crayon-e">movzx </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-i">al</span></div><div class="crayon-line" id="crayon-64eccedc18350656674655-5"><span class="crayon-cn">0000000140DDB5AD</span><span class="crayon-h"> </span><span class="crayon-e">test </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-i">eax</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18350656674655-6"><span class="crayon-cn">0000000140DDB5AF</span><span class="crayon-h"> </span><span class="crayon-e">jne </span><span class="crayon-i">bf4_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-cn">140DDB5B8</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18350656674655-7"><span class="crayon-cn">0000000140DDB5B1</span><span class="crayon-h"> </span><span class="crayon-st">xor</span><span class="crayon-h"> </span><span class="crayon-i">al</span><span class="crayon-sy">,</span><span class="crayon-i">al</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18350656674655-8"><span class="crayon-cn">0000000140DDB5B3</span><span class="crayon-h"> </span><span class="crayon-e">jmp </span><span class="crayon-i">bf4_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-cn">140DDB669</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>В Unravel он выглядел так:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18351302515962" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18351302515962-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18351302515962-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18351302515962-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18351302515962-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18351302515962-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18351302515962-6">6</div><div class="crayon-num" data-line="crayon-64eccedc18351302515962-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18351302515962-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18351302515962-1"><span class="crayon-cn">00000001416EBC2D</span><span class="crayon-h"> </span><span class="crayon-e">lea </span><span class="crayon-i">rcx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ss</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rsp</span>+<span class="crayon-cn">0x30</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18351302515962-2"><span class="crayon-cn">00000001416EBC32</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">sub_1417A5B80</span><span class="crayon-h">&gt;</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-64eccedc18351302515962-3"><span class="crayon-cn">00000001416EBC37</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">origin_startup</span><span class="crayon-h">&gt;</span><span class="crayon-c">// Вход! </span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18351302515962-4"><span class="crayon-cn">00000001416EBC3C</span><span class="crayon-h"> </span><span class="crayon-e">test </span><span class="crayon-i">al</span><span class="crayon-sy">,</span><span class="crayon-i">al</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18351302515962-5"><span class="crayon-cn">00000001416EBC3E</span><span class="crayon-h"> </span><span class="crayon-i">jne</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">loc_1416EBC50</span><span class="crayon-h">&gt;</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18351302515962-6"><span class="crayon-cn">00000001416EBC40</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-cn">0xC346A20F</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18351302515962-7"><span class="crayon-cn">00000001416EBC45</span><span class="crayon-h"> </span><span class="crayon-e">lea </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-e">dword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rax</span>+<span class="crayon-cn">0x3CB95E01</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18351302515962-8"><span class="crayon-cn">00000001416EBC4B</span><span class="crayon-h"> </span><span class="crayon-i">jmp</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">loc_1416EBDA4</span><span class="crayon-h">&gt;</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Во всех случаях бенефициантом является EAH, который при вызове этих 
процедур воплотится в куче (heap) как структура размером 968 байт (
			<span id="crayon-64eccedc18352369490366" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">mov </span><span class="crayon-i">ecx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3C8</span></span></span>).</p>
<p>Материализовавшись, EAH послужит тем Солсберийским шпилем, возле 
которого будет виться остальной OriginSDK. Нельзя пройти мимо 
сигнатурного обращения к ней — сначала OriginSDK интересуется: «А не 
ноль ли там?» Если нет, то только тогда тащит оттуда значение:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18354638842147" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18354638842147-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18354638842147-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18354638842147-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18354638842147-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18354638842147-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18354638842147-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18354638842147-1"><span class="crayon-cn">0000000140DE30D0</span><span class="crayon-h"> </span><span class="crayon-st">xor</span><span class="crayon-h"> </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-e">eax&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">is_EAH_init</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18354638842147-2"><span class="crayon-cn">0000000140DE30D2</span><span class="crayon-h"> </span><span class="crayon-e">cmp </span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-h">&lt;</span><span class="crayon-i">EAH</span><span class="crayon-h">&gt;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-i">rax</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-64eccedc18354638842147-3"><span class="crayon-cn">0000000140DE30D9</span><span class="crayon-h"> </span><span class="crayon-e">setne </span><span class="crayon-i">al</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// setne = Set if Not Equal. Эта инструкция как раз устанавливает байт в указанном операнде в значение 1, если нулевой флаг был очищен</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18354638842147-4"><span class="crayon-cn">0000000140DE30DC</span><span class="crayon-h"> </span><span class="crayon-i">ret</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18354638842147-5"><span class="crayon-cn">0000000140DE3DB0</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">rax</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-h">&lt;</span><span class="crayon-i">EAH</span><span class="crayon-h">&gt;</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-i">get_EAH</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18354638842147-6"><span class="crayon-cn">0000000140DE3DB7</span><span class="crayon-h"> </span><span class="crayon-i">ret</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<blockquote class="info"><p>Адреса EAH:</p>
<ul>
<li>Battlefield 4 (1.8. 2. 48475) — 0000000142789C80</li>
<li>Unravel — 0000000141344680</li>
</ul>
</blockquote>
<p>Внимание, фокус! Делаем заглушку на процедуре инициализации EAH (
			<span id="crayon-64eccedc18355113506496" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">mov </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span>&amp;<span class="crayon-h"> </span><span class="crayon-i">ret</span></span></span>),
 запускаем и видим, что логи отладчика заспамлены гневными сообщениями: 
«Origin Error: update fail The Origin SDK was not running». Это как раз 
происходит из-за того, что теперь EAH равен нулю и перестало выполняться
 ключевое условие — флаг готовности сетевого соединения в его дочерней 
структуре 
			<span id="crayon-64eccedc18356504673723" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">WSA_socket</span></span></span> не взведен:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18357499067722" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18357499067722-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18357499067722-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18357499067722-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18357499067722-1"><span class="crayon-cn">0000000141989FD0</span><span class="crayon-h"> </span><span class="crayon-e">cmp </span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rcx</span>+<span class="crayon-cn">50</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-e">FFFFFFFFFFFFFFFF </span><span class="crayon-i">is_connection_established</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18357499067722-2"><span class="crayon-cn">0000000141989FD5</span><span class="crayon-h"> </span><span class="crayon-e">setne </span><span class="crayon-i">al</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-64eccedc18357499067722-3"><span class="crayon-cn">0000000141989FD8</span><span class="crayon-h"> </span><span class="crayon-i">ret</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Кажется, у нас проблемы? Вовсе нет! Юмор в том, что это отнюдь не 
препятствие: после тщетных попыток связаться со своими из OriginCore 
хакнутая игрушка все равно соглашается запуститься. Занавес и выход на 
бис!</p>
<h2 id="layfhaki-dlya-dalneyshego-kovyryaniya-denuvo">Лайфхаки для дальнейшего ковыряния Denuvo</h2>
<p>Ходят слухи, что при взломе Denuvo нужно процессить колбэки EA. 
Однако мы на них забили, так как у меня OriginSDK ни разу из-за этого не
 падал.</p>
<p>Иногда после патчинга при запуске игрушки вместо меню появляется 
черный экран с характерным символом, который «прыгает» или «мигает». В 
Battlefield 4 таким символом будет мигающее подчеркивание в верхнем 
правом углу. В Unravel — точка в нижнем правом углу. Это говорит о том, 
что OriginSDK не может преодолеть языковой барьер.</p>
<p>На скриншоте — сигнатурная языковая проверка в Battlefield 4. Этот 
«подводный камень» нужно фиксить вместе с патчингом процедуры 
инициализации EAH. Origin SDK ломается именно таким образом.</p>
<p><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-2.png" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8003" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-2.png" alt="защита denuvo" width="1745" height="724" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-2.png 1745w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-2-768x319.png 768w" sizes="(max-width: 1745px) 100vw, 1745px"><meta itemprop="width" content="1745"><meta itemprop="height" content="724"></span></a></p>
<p>Дело в том, что через EAH, кроме всякого мусора, приходит список языков, на которых игрушка может общаться с геймером: 
			<span id="crayon-64eccedc18359252280499" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">en_US</span></span></span>, 
			<span id="crayon-64eccedc1835a931783173" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">ru_RU</span></span></span>, 
			<span id="crayon-64eccedc1835b559245247" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">jp_JP</span></span></span>… Для их указания используется глобальный флаг, из-за ошибки инициализации которого в конце процедуры 
			<span id="crayon-64eccedc1835c749606922" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Origin_startup</span></span></span> и возникает данное недоразумение. Сигнатурный switch показан на картинке ниже.</p>
<figure id="attachment_8004" aria-describedby="caption-attachment-8004" style="width: 1173px" class="wp-caption aligncenter"><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-3.png" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" loading="lazy" class="size-full wp-image-8004" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-3.png" alt="Структура Electronic Arts handle (EAH)" width="1173" height="962" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-3.png 1173w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-3-768x630.png 768w" sizes="(max-width: 1173px) 100vw, 1173px"><meta itemprop="width" content="1173"><meta itemprop="height" content="962"></span></a><figcaption id="caption-attachment-8004" class="wp-caption-text">Структура Electronic Arts handle (EAH)</figcaption></figure>
<p>Столкнувшись с этой проблемой, попробуй использовать ручной ввод языка игрушки, например через ключ 
			<span id="crayon-64eccedc1835e023967048" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;">-<span class="crayon-i">force_language</span></span></span>, указываемый при запуске.<br>
Подведем промежуточный итог: собственно взлом Origin — это блокировка инициализации EAH путем установки заглушки на процедуру 
			<span id="crayon-64eccedc1835f918230952" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Origin_startup</span></span></span>.
 Отсутствие связи с Хьюстоном не преграда для запуска игрушки (в крайнем
 случае мы просто фиксим языковой барьер). Сам EAH в исследуемых версиях
 не содержит чувствительных данных, а для проверок флагов используются 
только условные переходы.</p><div class="b-r b-r--after-p"><script async="" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/adsbygoogle.js"></script>
<!-- techgeekru middle adaptive -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5859973253765166" data-ad-slot="1066592675" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>

<h2 id="deobfuskatsiya-eah">Деобфускация EAH</h2>
<p>Выше я писал о «всяком мусоре». Что же такого в EAH напихали 
заморские разработчики? В ней реализована поддержка вычислений 
хеш-функции SHA-160, шифрования AES и телеметрии (у версий старше 2015 
года). До кучи в EAH выполняется загрузка 
			<span id="crayon-64eccedc18360365602269" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">IGO64</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span> из папки 
			<span id="crayon-64eccedc18361502889853" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-sy">\</span><span class="crayon-i">Origin</span><span class="crayon-sy">\</span></span></span>.
 Еще там есть EALS (Electronic Arts LSX). Это не самая удачная вложенная
 аббревиатура, где LSX означает XML Schema Processor Messages. Штука, 
которая нужна для сверки XML-корреспонденции.</p>
<p>Ее структура получается примерно такой:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18363351949865" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -29px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18363351949865-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-6">6</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-8">8</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-10">10</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-12">12</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-14">14</div><div class="crayon-num" data-line="crayon-64eccedc18363351949865-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18363351949865-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18363351949865-1"><span class="crayon-h">&lt;</span><span class="crayon-i">LSX</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-2"><span class="crayon-h">&lt;</span><span class="crayon-e">Response </span><span class="crayon-i">id</span>=<span class="crayon-s">"3"</span><span class="crayon-h"> </span><span class="crayon-i">sender</span>=<span class="crayon-s">"EbisuSDK"</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-3"><span class="crayon-h">&lt;</span><span class="crayon-e">GetProfileResponse </span><span class="crayon-i">AvatarId</span>=<span class="crayon-s">"%LOCALAPPDATA%\Origin\AvatarsCache\многоцифрбукв.jpg#26813913"</span><span class="crayon-h"> </span><span class="crayon-i">CommerceCountry</span>=<span class="crayon-s">"RU"</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-4"><span class="crayon-i">IsTrialSubscriber</span>=<span class="crayon-s">"false"</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-5"><span class="crayon-i">SubscriberLevel</span>=<span class="crayon-s">"0"</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-6"><span class="crayon-i">Persona</span>=<span class="crayon-s">"XAKEP.RU"</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-7"><span class="crayon-i">IsUnderAge</span>=<span class="crayon-s">"false"</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-8"><span class="crayon-i">CommerceCurrency</span>=<span class="crayon-s">"RUB"</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-9"><span class="crayon-i">Country</span>=<span class="crayon-s">"RU"</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-10"><span class="crayon-i">UserIndex</span>=<span class="crayon-s">"0"</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-11"><span class="crayon-i">IsSubscriber</span>=<span class="crayon-s">"false"</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-12"><span class="crayon-i">GeoCountry</span>=<span class="crayon-s">"RU"</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-13"><span class="crayon-i">PersonaId</span>=<span class="crayon-s">"0000001"</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-14"><span class="crayon-i">UserId</span>=<span class="crayon-s">"000002"</span>/<span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc18363351949865-15"><span class="crayon-h">&lt;</span>/<span class="crayon-i">Response</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18363351949865-16"><span class="crayon-h">&lt;</span>/<span class="crayon-i">LSX</span><span class="crayon-h">&gt;</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Все данные, которые представляют хоть какой-то практический интерес, всегда помещаются в <s>/dev/null</s> конец структуры EAH.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18364979294567" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -29px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18364979294567-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-6">6</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-8">8</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-10">10</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-12">12</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-14">14</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-16">16</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-18">18</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-20">20</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-22">22</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-24">24</div><div class="crayon-num" data-line="crayon-64eccedc18364979294567-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18364979294567-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18364979294567-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EA_HANDLE_MAIN_STACK</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-3"><span class="crayon-c">//--- WSA, где содержатся все данные о сетевом соединении c OriginCORE---S_EA_WSA_ADDON wsa_stack_45;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-4"><span class="crayon-c">//WSA_Startup((__int64)&amp;_RBX-&gt;field_0[45])</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-5"><span class="crayon-c">// Стек входящих сообщений в сыром виде, которые были обработаны потоком, отвечающим за получение данных</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-6"><span class="crayon-e">LPVOID </span><span class="crayon-i">filed_63__array_4</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-7"><span class="crayon-e">LPVOID </span><span class="crayon-i">filed_68__array_4</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-8"><span class="crayon-e">LPVOID </span><span class="crayon-i">filed_73__array_4</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-9">/<span class="crayon-h"> </span>/<span class="crayon-i">ID</span><span class="crayon-h"> </span>отправленных<span class="crayon-h"> </span>сообщений<span class="crayon-h"> </span><span class="crayon-e">WSA_Startup</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-10"><span class="crayon-e">size_t </span><span class="crayon-i">send_MESSAGE_ID_inc_78</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-11"><span class="crayon-e">size_t </span><span class="crayon-i">filed_79_array_26</span><span class="crayon-sy">[</span><span class="crayon-cn">26</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-12"><span class="crayon-e">size_t </span><span class="crayon-i">PROBE_105</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-13"><span class="crayon-c">// ГОТОВЫЕ ДАННЫЕ</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-14"><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-i">ORIGIN_CORE_VER_106</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-15"><span class="crayon-e">size_t </span><span class="crayon-i">origin_core_ver_len_108</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-16"><span class="crayon-e">size_t </span><span class="crayon-i">max_origin_core_ver_len_109</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-17"><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-i">game_id</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-18"><span class="crayon-e">size_t </span><span class="crayon-i">game_id_len_112</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-19"><span class="crayon-e">size_t </span><span class="crayon-i">max_game_id_len_113</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-20"><span class="crayon-e">size_t </span><span class="crayon-i">reserved__114</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-21"><span class="crayon-e">size_t </span><span class="crayon-i">reserved__115</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-22"><span class="crayon-e">size_t </span><span class="crayon-i">reserved__116</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-23"><span class="crayon-e">size_t </span><span class="crayon-i">reserved__117</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-24"><span class="crayon-e">size_t </span><span class="crayon-i">reserved__118</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18364979294567-25"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18364979294567-26"><span class="crayon-i">EA_HANDLE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>*<span class="crayon-i">pEA_HANDLE</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Вся эта «секретная» информация имеет шанс найти применение у 
вирусописателей. Уверен, они будут счастливы возможности заставить 
игрушку запускать вредоносный код несколькими путями. Подробнее смотри 
дальше в описании Denuvo_TLS.</p>
<h2 id="denuvo-vmprotect-love">Denuvo + VMProtect = love</h2>
<p>Вот и настало время для обещанной истории про то, как Denuvo защищает Origin SDK.</p>
<p>Сигнатурные «руки Блауковича» принимают свои очертания при работе с 
константами исходного кода игрушки и Origin SDK. Для примера возьмем 
кусок кода из распакованного 
			<span id="crayon-64eccedc18365643566683" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></span></span> (его хеш MD5: 
			<span id="crayon-64eccedc18367907365897" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">81095fae682c6821f07d9555b0901548</span></span></span>).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18368226151961" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18368226151961-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18368226151961-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18368226151961-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18368226151961-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18368226151961-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18368226151961-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18368226151961-1"><span class="crayon-cn">0000000141958B2A</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">:</span><span class="crayon-cn">8D15</span><span class="crayon-h"> </span><span class="crayon-e">EF7ED8FE </span><span class="crayon-e">lea </span><span class="crayon-i">rdx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-h">&lt;</span><span class="crayon-i">aOriginstartupE</span><span class="crayon-h">&gt;</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18368226151961-2"><span class="crayon-cn">0000000141958B31</span><span class="crayon-h"> </span><span class="crayon-i">B9</span><span class="crayon-h"> </span><span class="crayon-cn">0FA2FFE7</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">ecx</span><span class="crayon-sy">,</span><span class="crayon-i">E7FFA20F</span></div><div class="crayon-line" id="crayon-64eccedc18368226151961-3"><span class="crayon-cn">0000000141958B36</span><span class="crayon-h"> </span><span class="crayon-cn">4C</span><span class="crayon-sy">:</span><span class="crayon-cn">89CB</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">rbx</span><span class="crayon-sy">,</span><span class="crayon-i">r9</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18368226151961-4"><span class="crayon-cn">0000000141958B39</span><span class="crayon-h"> </span><span class="crayon-cn">4C</span><span class="crayon-sy">:</span><span class="crayon-cn">89C7</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">rdi</span><span class="crayon-sy">,</span><span class="crayon-i">r8</span></div><div class="crayon-line" id="crayon-64eccedc18368226151961-5"><span class="crayon-cn">0000000141958B3C</span><span class="crayon-h"> </span><span class="crayon-cn">8D89</span><span class="crayon-h"> </span><span class="crayon-e">F15D001B </span><span class="crayon-e">lea </span><span class="crayon-i">ecx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rcx</span>+<span class="crayon-cn">1B005DF1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18368226151961-6"><span class="crayon-cn">0000000141958B42</span><span class="crayon-h"> </span><span class="crayon-i">E8</span><span class="crayon-h"> </span><span class="crayon-cn">690F0300</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">EA_CALLBACK</span><span class="crayon-h">&gt;</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Этот фрагмент, переваренный декомпилятором Hex-Rays в псевдокод, выглядит так:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18369328096100" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18369328096100-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18369328096100-1"><span class="crayon-e">EA_CALLBACK</span><span class="crayon-sy">(</span><span class="crayon-cn">0x3000000i64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">aOriginstartupE</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><figure id="attachment_8002" aria-describedby="caption-attachment-8002" style="width: 750px" class="wp-caption aligncenter"><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-2.jpg" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" loading="lazy" class="size-full wp-image-8002" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-2.jpg" alt="Рейнгард Блаукович тоже читает «Тибериумный реверсинг»" width="750" height="496"><meta itemprop="width" content="750"><meta itemprop="height" content="496"></span></a><figcaption id="caption-attachment-8002" class="wp-caption-text">Рейнгард Блаукович тоже читает «Тибериумный реверсинг»</figcaption></figure><p></p>
<p>Что здесь не так? Обычно первый аргумент — регистр 
			<span id="crayon-64eccedc1836a208652972" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">rcx</span></span></span>. Он складывается из двух констант: 
			<span id="crayon-64eccedc1836c146294733" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">E7FFA20F</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1B005DF1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">103000000</span></span></span>. С учетом того, что все операции выполняются над четырехбайтным регистром, окончательный результат, выданный Hex-Rays, равен 
			<span id="crayon-64eccedc1836d713418097" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0x3000000</span></span></span>. Компилятор на стадии оптимизации повторил бы то же самое. Значит, константа 
			<span id="crayon-64eccedc1836e773495591" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0x3000000</span></span></span> была намеренно разбита на две части.</p>
<p>Присмотримся ближе к первому операнду слагаемого: 
			<span id="crayon-64eccedc1836f060705785" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">B9</span><span class="crayon-h"> </span><span class="crayon-cn">0FA2FFE7</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">ecx</span><span class="crayon-sy">,</span><span class="crayon-i">E7FFA20F</span></span></span>.
 Почему именно операнд, Холмс? Наверное, под него проще подобрать 
ассемблерную инструкцию, которую можно скрыть внутри. То есть 
использовать традиционный прыжок «в середину инструкции» 
			<span id="crayon-64eccedc18370709236782" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0FA2</span></span></span>… Для проверки этой догадки заменим опкод 
			<span id="crayon-64eccedc18372600072385" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">B9</span></span></span> на 
			<span id="crayon-64eccedc18373440661712" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">90</span></span></span> «nop — ничего не делать».</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18374154948370" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18374154948370-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18374154948370-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18374154948370-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18374154948370-1"><span class="crayon-cn">0000000141958B31</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-h"> </span><span class="crayon-i">nop</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18374154948370-2"><span class="crayon-cn">0000000141958B32</span><span class="crayon-h"> </span><span class="crayon-cn">0FA2</span><span class="crayon-h"> </span><span class="crayon-i">cpuid</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-64eccedc18374154948370-3"><span class="crayon-cn">0000000141958B34</span><span class="crayon-h"> </span><span class="crayon-e">FFE7 </span><span class="crayon-e">jmp </span><span class="crayon-i">rdi</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>CPUID — статическая компиляция для проверки лицензии Denuvo. Естественно, после ее использования нужен 
			<span id="crayon-64eccedc18375602992760" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">jmp </span><span class="crayon-i">rdi</span></span></span> для возврата управления. Это «правая рука», а «левая» — системный вызов, которым Origin SDK выделяет память для EAH:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18376398040580" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18376398040580-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18376398040580-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18376398040580-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18376398040580-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18376398040580-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18376398040580-6">6</div><div class="crayon-num" data-line="crayon-64eccedc18376398040580-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18376398040580-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18376398040580-1"><span class="crayon-c">// Вот как эти «руки»…</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18376398040580-2"><span class="crayon-cn">000000014195C350</span><span class="crayon-h"> </span><span class="crayon-i">B9</span><span class="crayon-h"> </span><span class="crayon-cn">0F054FC3</span><span class="crayon-h"> </span><span class="crayon-e">mov </span><span class="crayon-i">ecx</span><span class="crayon-sy">,</span><span class="crayon-i">C34F050F</span></div><div class="crayon-line" id="crayon-64eccedc18376398040580-3"><span class="crayon-cn">000000014195C355</span><span class="crayon-h"> </span><span class="crayon-cn">8D89</span><span class="crayon-h"> </span><span class="crayon-e">A9FEB03C </span><span class="crayon-e">lea </span><span class="crayon-i">ecx</span><span class="crayon-sy">,</span><span class="crayon-e">qword </span><span class="crayon-e">ptr </span><span class="crayon-i">ds</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-i">rcx</span>+<span class="crayon-cn">3CB0FEA9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18376398040580-4"><span class="crayon-cn">000000014195C35B</span><span class="crayon-h"> </span><span class="crayon-e">E8 </span><span class="crayon-e">A0D80200 </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">malloc_0</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc18376398040580-5"><span class="crayon-c">// …трансформируются в «крюки»</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18376398040580-6"><span class="crayon-cn">000000014195C350</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-h"> </span><span class="crayon-i">nop</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-64eccedc18376398040580-7"><span class="crayon-cn">000000014195C351</span><span class="crayon-h"> </span><span class="crayon-cn">0F05</span><span class="crayon-h"> </span><span class="crayon-i">syscall</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18376398040580-8"><span class="crayon-cn">000000014195C353</span><span class="crayon-h"> </span><span class="crayon-cn">4F</span><span class="crayon-sy">:</span><span class="crayon-e">C3 </span><span class="crayon-i">ret</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Сигнатурное разделение на два слагаемых для первого аргумента легко 
выявить в исходном коде (мы же знаем, где все процедуры Origin SDK 
расположены). Кроме того, нам известно, что вся эта «оранжевая музыка» 
ломается за пару кликов. Исполнение исходного кода Origin SDK в этом 
варианте развития событий вовсе не требуется (код будет лежать мертвым 
грузом). Поэтому ничто не помешает нам перезаписать его хакнутыми 
инструкциями. Короче, Denuvo свою лицензию проверяет через динамику. 
Какой смысл вообще в этих статических извращениях?!</p>
<p>Далее идет еще более странное (может, для кого-то даже смешное) 
поведение австрийских парней. Кусок кода, который отвечает за генерацию 
открытого ключа для обмена LSX-сообщениями:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc18378605338136" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc18378605338136-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18378605338136-2">2</div><div class="crayon-num" data-line="crayon-64eccedc18378605338136-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18378605338136-4">4</div><div class="crayon-num" data-line="crayon-64eccedc18378605338136-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc18378605338136-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc18378605338136-1"><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-i">out</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// [rsp+5E0h] [rbp+4E0h]</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18378605338136-2">…</div><div class="crayon-line" id="crayon-64eccedc18378605338136-3"><span class="crayon-e">sub_14199AB30</span><span class="crayon-sy">(</span><span class="crayon-sy">&amp;ctx);</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18378605338136-4"><span class="crayon-i">randr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">GetTickCount</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc18378605338136-5"><span class="crayon-e">sub_141999F80</span><span class="crayon-sy">(</span><span class="crayon-sy">&amp;ctx, &amp;randr, 4i64);</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc18378605338136-6"><span class="crayon-e">sub_14199A8A0</span><span class="crayon-sy">(</span><span class="crayon-sy">&amp;ctx, out);</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Здесь первая процедура 
			<span id="crayon-64eccedc18379988208753" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">sub_14199AB30</span><span class="crayon-sy">(</span><span class="crayon-h">&amp;ctx</span><span class="crayon-sy">)</span></span></span> выполняет нехитрые вычисления:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc1837a480989262" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -29px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc1837a480989262-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837a480989262-2">2</div><div class="crayon-num" data-line="crayon-64eccedc1837a480989262-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837a480989262-4">4</div><div class="crayon-num" data-line="crayon-64eccedc1837a480989262-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837a480989262-6">6</div><div class="crayon-num" data-line="crayon-64eccedc1837a480989262-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837a480989262-8">8</div><div class="crayon-num" data-line="crayon-64eccedc1837a480989262-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837a480989262-10">10</div><div class="crayon-num" data-line="crayon-64eccedc1837a480989262-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc1837a480989262-1"><span class="crayon-e">_int64 </span><span class="crayon-e">__fastcall </span><span class="crayon-e">sub_14199AB30</span><span class="crayon-sy">(</span><span class="crayon-e">__int64 </span><span class="crayon-i">a1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837a480989262-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-64eccedc1837a480989262-3"><span class="crayon-h"> </span><span class="crayon-e">__int64 </span><span class="crayon-i">result</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// rax</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837a480989262-4"><span class="crayon-i">result</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc1837a480989262-5">*<span class="crayon-sy">(</span><span class="crayon-e ">_DWORD *</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">a1</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x67452301</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837a480989262-6">*<span class="crayon-sy">(</span><span class="crayon-e ">_DWORD *</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">a1</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0xEFCDAB89</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc1837a480989262-7">*<span class="crayon-sy">(</span><span class="crayon-e ">_DWORD *</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">a1</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x98BADCFE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837a480989262-8">*<span class="crayon-sy">(</span><span class="crayon-e ">_DWORD *</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-i">a1</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x10325476</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc1837a480989262-9">*<span class="crayon-sy">(</span><span class="crayon-e ">_QWORD *</span><span class="crayon-sy">)</span><span class="crayon-i">a1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0i64</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837a480989262-10"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">result</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc1837a480989262-11"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>«Да ведь это же MD5!» — воскликнет наблюдательный читатель и будет 
абсолютно прав! То есть в читабельном виде код из Hex-Rays выглядит так:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc1837b332907575" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc1837b332907575-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837b332907575-2">2</div><div class="crayon-num" data-line="crayon-64eccedc1837b332907575-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc1837b332907575-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc1837b332907575-1"><span class="crayon-e">MD5_Init</span><span class="crayon-sy">(</span><span class="crayon-sy">&amp;ctx);</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837b332907575-2"><span class="crayon-i">randr</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">GetTickCount</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-64eccedc1837b332907575-3"><span class="crayon-e">MD5_Update</span><span class="crayon-sy">(</span><span class="crayon-sy">&amp;ctx, &amp;randr, 4i64);</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc1837b332907575-4"><span class="crayon-e">MD5_Final</span><span class="crayon-sy">(</span><span class="crayon-sy">&amp;ctx, out);</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Позвольте, сударь! Где же в приведенных выше примерах «мощная и 
непробиваемая защита™» Denuvo? А нет ее! При помощи VMProtect 2 накрыты 
внутренности 
			<span id="crayon-64eccedc1837d397775950" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">MD5_Update</span><span class="crayon-sy">(</span><span class="crayon-h">&amp;ctx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-h">&amp;randr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4i64</span><span class="crayon-sy">)</span></span></span>, причем только переходы между основными операциями процедуры. То есть копирование памяти 
			<span id="crayon-64eccedc1837e342977133" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">memcpy</span></span></span>, раунды — все это открыто!</p>
<p>По сути, в Denuvo «защищается» виртуализацией то, что абсолютно никак
 не связано с EAH. Например, рандомно генерируемые значения 
			<span id="crayon-64eccedc1837f894078284" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">GetTickCount</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></span></span>. К тому же конечный результат всегда можно увидеть после 
			<span id="crayon-64eccedc18380999565405" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">MD5_Final</span></span></span>, который никто не трогал.</p>

<p>В истории разработки Denuvo еще была техника «воровства» нескольких 
ASM-инструкций в выделенную память. Это такой ламерский антидамп, 
известный еще со времен SafeDisk и первых CD-ROM. Этот детский сад 
быстро убрали, чтобы не позориться в XXI веке.</p>
<p>Отдельной строкой хотел упомянуть хайп, поднимающийся в Сети, когда 
очередной блогер выясняет, насколько сильно проседает FPS в игре, 
защищенной Denuvo. М-да! «А мужики-то и не знают» до сих пор о таких 
очевидно негативных последствиях бездумного использования виртуальной 
машины.</p>
<h2 id="denuvo-keygen-or-not">Denuvo keygen or not</h2>
<p>«Наша защита — это только anti-tamper», — говорили на презентации 
Denuvo. Разработчики вводили в заблуждение, пускали пыль в глаза… но 
только не читателям журнала «Хакер». Тайна, покрытая VMProtect, с самого
 начала не давала никому покоя. Не подвергалось сомнению, что защита 
использует лицензию для привязки к железу.</p>
<p>Первой ласточкой стало раскрытие критически важных элементов этой 
привязки. Как оказалось, они не повторяют путь SecuROM, и DES с RSA 
здесь нет. Перечислим данные, к которым обращается защита на твоей 
машине. Они уже давно известны и изучены.</p>
<ol>
<li>Инструкция 
			<span id="crayon-64eccedc18398239640161" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">CPUID</span></span></span>.
 В отличие от применявшейся в других защитах инструкции чтения счетчика 
циклов — RDTSC (Read Time Stamp Counter), на ней нельзя поставить 
исключение и тормознуть выполнение потока. Поэтому быстрого решения 
хакнуть возвращаемые данные в любом месте нет. Ну как нет, в том же 
«Клубке» (Unravel) она всегда выполняется в динамике и под нее выделено 
два блока памяти — так что атрибут 
			<span id="crayon-64eccedc1839d299159656" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">NO_ACCESS</span></span></span> еще никто не отменял.</li>
<li>Трио 
			<span id="crayon-64eccedc1839f429526130" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">kernel32</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span>, 
			<span id="crayon-64eccedc183a0113667198" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">ntdll</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span> и 
			<span id="crayon-64eccedc183a2257495698" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">kernelbase</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span> с их массивом записей 
			<span id="crayon-64eccedc183a3607654942" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">IMAGE_DATA_DIRECTORY</span></span></span>.
 При наличии исходников Windows эту привязку (и следующие две, кстати, 
тоже) очень просто было бы обойти, создав для Denuvo специальную 
			<span id="crayon-64eccedc183a4654319395" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">FAKE_IMAGE_DATA_DIRECTORY</span></span></span>, а Windows можно было бы оставить на оригинальной.</li>
<li>Структура 
			<span id="crayon-64eccedc183a5414463898" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">KUSER_SHARED_DATA</span></span></span>
 по неизменному адресу «Бейкер-стрит, 0x07FFE0000». Это тот самый 
случай, когда Windows 7 круче «десятки» и «восьмерки» вместе взятых. 
«Семерка» позволяет спокойно редактировать эту область в ring 3!</li>
<li>Счетчик 
			<span id="crayon-64eccedc183a6585643036" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">KSYSTEM_TIME</span></span></span>
 — «The Times», именно с этой дочерней структурой связаны слова 
Рейнгарда Блауковича о том, что «…вы никогда не узнаете, как работает 
алгоритм проверки лицензии, так как она всегда меняется при каждом 
запуске игры». От себя могу добавить, что если в «семерке» поправить 
содержимое системного счетчика, то он «остановится» и тогда вы точно 
никогда не узнаете, как он работает, а еще никогда не увидите OEP и 
никогда не поиграете в свою любимую игрушку, так как Denuvo понимает, 
что алгоритм в этом случае уже меняться не будет, и впадает в депрессию —
 бесконечный цикл опроса счетчика 
			<span id="crayon-64eccedc183a8312316797" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">KSYSTEM_TIME</span></span></span>. Такие дела!</li>
<li>Структура данных «блок среды процесса» (PEB — Process Environment Block). Он же 
			<span id="crayon-64eccedc183ab341436672" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">mov </span><span class="crayon-i">rax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">gs</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-cn">0x60</span><span class="crayon-sy">]</span></span></span>, он же 
			<span id="crayon-64eccedc183ad509122459" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-e">mov </span><span class="crayon-i">eax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">fs</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-cn">0x30</span><span class="crayon-sy">]</span></span></span>.
 Во всех версиях Windows его можно перезаписать. Он наименее 
чувствителен к изменениям, то есть шанс завалить нормальную работу 
процесса игрушки при манипуляциях с ним очень мал.</li>
</ol>
<p>Предлагаю пофантазировать о том, что можно сделать с этими данными. Как думаешь, уважаемый читатель?</p>
<p>Ответ тривиален и полон лулзов: забить все четыре блока нулями и 
отправить Блауковичу в качестве request code для генерации лицухи. Ты 
будешь смеяться, но это работает до сих пор! Сервер Denuvo не проверяет 
очевидную туфту, которую ему подсовывают, и соглашается, что у кого-то 
количество процессоров равно нулю, а Windows не имеет собственной 
директории. На фоне всего этого уже не выглядят странно системные 
библиотеки с пустым массивом 
			<span id="crayon-64eccedc183ae849129023" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">IMAGE_DATA_DIRECTORY</span></span></span> — без экспорта, без импорта и релоков.</p>
<p>Сервак Denuvo, подобно любвеобильной куртизанке, не откажет никому! 
Это значит, что в ответ на грубый запрос нам прислали прямо с родины 
Фрейда лицуху с расширением .dlf. Лицензионное соглашение EA Origin 
здесь никто не читал, поэтому спокойно распаковываем ее содержимое и 
видим XML:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc183b0835060698" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -29px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc183b0835060698-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183b0835060698-2">2</div><div class="crayon-num" data-line="crayon-64eccedc183b0835060698-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183b0835060698-4">4</div><div class="crayon-num" data-line="crayon-64eccedc183b0835060698-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183b0835060698-6">6</div><div class="crayon-num" data-line="crayon-64eccedc183b0835060698-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183b0835060698-8">8</div><div class="crayon-num" data-line="crayon-64eccedc183b0835060698-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183b0835060698-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc183b0835060698-1"><span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span>=<span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span>=<span class="crayon-s">"UTF-8"</span><span class="crayon-h"> </span><span class="crayon-i">standalone</span>=<span class="crayon-s">"yes"</span><span class="crayon-ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183b0835060698-2"><span class="crayon-h">&lt;</span><span class="crayon-e">License </span><span class="crayon-i">xmlns</span>=<span class="crayon-s">"http://ea.com/license"</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc183b0835060698-3"><span class="crayon-h">&lt;</span><span class="crayon-i">CipherKey</span><span class="crayon-h">&gt;</span>трэш<span class="crayon-h">&lt;</span>/<span class="crayon-i">CipherKey</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183b0835060698-4"><span class="crayon-h">&lt;</span><span class="crayon-i">MachineHash</span><span class="crayon-h">&gt;</span>трэш<span class="crayon-h">&lt;</span>/<span class="crayon-i">MachineHash</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc183b0835060698-5"><span class="crayon-h">&lt;</span><span class="crayon-i">ContentId</span><span class="crayon-h">&gt;</span>циферки<span class="crayon-h">&lt;</span>/<span class="crayon-i">ContentId</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183b0835060698-6"><span class="crayon-h">&lt;</span><span class="crayon-i">UserId</span><span class="crayon-h">&gt;</span>трэш<span class="crayon-h">&lt;</span>/<span class="crayon-i">UserId</span><span class="crayon-h">&gt;</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-64eccedc183b0835060698-7"><span class="crayon-h">&lt;</span><span class="crayon-i">GameToken</span><span class="crayon-h">&gt;</span>много<span class="crayon-h"> </span>буков<span class="crayon-h"> </span>и<span class="crayon-h"> </span>циферок<span class="crayon-h">&lt;</span>/<span class="crayon-i">GameToken</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183b0835060698-8"><span class="crayon-h">&lt;</span><span class="crayon-i">GrantTime</span><span class="crayon-h">&gt;</span>лютый<span class="crayon-h"> </span>треш<span class="crayon-h">&lt;</span>/<span class="crayon-i">GrantTime</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc183b0835060698-9"><span class="crayon-h">&lt;</span><span class="crayon-i">StartTime</span><span class="crayon-h">&gt;</span>лютый<span class="crayon-h"> </span>треш<span class="crayon-h">&lt;</span>/<span class="crayon-i">StartTime</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183b0835060698-10"><span class="crayon-h">&lt;</span>/<span class="crayon-i">License</span><span class="crayon-h">&gt;</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>Среди всей это белиберды систему Denuvo (и нас) интересуют только два тега:</p>
<ol>
<li><strong>ContentId</strong> — зашитый в игрушке и полученный в 
лицензии идентификатор контента сверяется простым сравнением строк 
(strcmp). Выполняется один условный переход.</li>
<li><strong>GameToken</strong> — самый интригующий тег. Применительно к 
Unravel это 214 32-битных целых чисел (DWORDs), которые поксорены 
константами, разбиты по байтам и имеют привязку к четырем упомянутым 
выше блокам (
			<span id="crayon-64eccedc183b1824989243" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">CPUID</span></span></span>, 
			<span id="crayon-64eccedc183b2685482659" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">PEB</span></span></span>, 
			<span id="crayon-64eccedc183b5332460813" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">KUSER_SHARED_DATA</span></span></span> и 
			<span id="crayon-64eccedc183b7235113387" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">IMAGE_DATA_DIRECTORY</span></span></span>). Привязка индивидуальна. Вот, собственно, то, что и требуется закейгенить… но не в этой статье.</li>
</ol>
<p>Пока что полный вперед прежним курсом. Наши координаты по отладчику x64dbg — секция 
			<span id="crayon-64eccedc183b9163812265" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-sy">.</span><span class="crayon-i">bss</span></span></span>, которая отличается следующим поведением:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-64eccedc183ba635185520" class="crayon-syntax crayon-theme-idle crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" no-popup minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; clear: none; font-size: 15px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<div class="table-responsive"><div class="table-responsive"><table class="crayon-table" style="margin-left: -20px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-64eccedc183ba635185520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183ba635185520-2">2</div><div class="crayon-num" data-line="crayon-64eccedc183ba635185520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-64eccedc183ba635185520-4">4</div><div class="crayon-num" data-line="crayon-64eccedc183ba635185520-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-64eccedc183ba635185520-1"><span class="crayon-cn">00000001413B8273</span><span class="crayon-h"> </span><span class="crayon-e">sub </span><span class="crayon-i">rsp</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183ba635185520-2"><span class="crayon-cn">00000001413B8277</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">Denuvo_TLS</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-64eccedc183ba635185520-3"><span class="crayon-cn">00000001413B827C</span><span class="crayon-h"> </span><span class="crayon-i">call</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">unravel_dump_scy</span><span class="crayon-sy">.</span><span class="crayon-i">Denuvo_LIC_CHECK</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-64eccedc183ba635185520-4"><span class="crayon-cn">00000001413B8281</span><span class="crayon-h"> </span><span class="crayon-e">add </span><span class="crayon-i">rsp</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span></div><div class="crayon-line" id="crayon-64eccedc183ba635185520-5"><span class="crayon-cn">00000001413B8285</span><span class="crayon-h"> </span><span class="crayon-i">ret</span></div></div></td>
					</tr>
				</tbody></table></div></div>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Здесь 
			<span id="crayon-64eccedc183bb031888517" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Denuvo_TLS</span></span></span> — настоящая находка для вирусописателей: не нужно палиться с функцией 
			<span id="crayon-64eccedc183bc741718569" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">CreateRemoteThreadEx</span></span></span>. Достаточно использовать 
			<span id="crayon-64eccedc183bd621205059" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">WriteProcessMemory</span></span></span>,
 отправив в глобальный стек защиты адрес своего кода, и Denuvo сам 
подхватит управление. Кстати, он расположен в этой же секции, так что 
немецкая педантичность не обошла защиту стороной.</p>
<p>Переместим фокус на процедуру 
			<span id="crayon-64eccedc183bf455862500" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">Denuvo_LIC_CHECK</span></span></span>.
 Позади — распаковка кода игры и Origin SDK с антиотладочными трюками, 
впереди — контрольная проверка лицензии, после нее — OEP и триггеры 
защиты, в которых тоже проверяется лицуха.</p>
<p>Важно то, что до OEP проверка лицензии имеет два фундаментальных 
отличия от кода защиты, который просто чекает лицуху после проследования
 станции метро «OEP» где-то на зеленой ветке:</p>
<ol>
<li>
			<span id="crayon-64eccedc183c0294771472" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">LIC_CHECK</span></span></span> расшифровывает и раскидывает секретные DWORD по своим местам для триггеров, срабатывающих после OEP.</li>
<li>Также он выполняет контрольную проверку всей таблицы из 214 двойных слов.</li>
</ol>
<p>Сейчас будет небольшая сенсация. Начинаем движение и шаг за шагом перемещаемся по процедуре LIC_CHECK в сторону OEP:</p>
<ol>
<li>Читаем 
			<span id="crayon-64eccedc183c1009459073" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">dbdata</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></span></span>
 и проверяем ее водяной знак. С помощью этой либы формируется код 
запроса, подмена которого уже была показана в исследовании «Тибериумный 
реверсинг. В погоне за взломом Denuvo» (см. видео по ссылке из блока 
«WWW»).</li>
<li>Читаем саму лицуху 
			<span id="crayon-64eccedc183c2264224369" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">1031469.dlf</span></span></span> по следующему адресу: 
			<span id="crayon-64eccedc183c3533501113" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-sy">%</span><span class="crayon-i">ProgramData</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-e">Electronic </span><span class="crayon-i">Arts</span><span class="crayon-sy">\</span><span class="crayon-e">EA </span><span class="crayon-i">Services</span><span class="crayon-sy">\</span><span class="crayon-i">License</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span></span></span>. Извлекаем 
			<span id="crayon-64eccedc183c5897567934" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">ContentId</span></span></span> и убеждаемся, что он равен 
			<span id="crayon-64eccedc183c6628667105" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">1031469</span></span></span>. Извлекаем 
			<span id="crayon-64eccedc183c7519068157" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">GameToken</span></span></span>,
 расшифровываем его, ксорим константами, затем раскидываем таблицу по 
всей секции в строго отведенные места, которые находятся за возвратом 
(RET) основных процедур игрушки.</li>
<li>Из сорока контекстов виртуальной машины VMProtect 2 на защиту 
			<span id="crayon-64eccedc183d7424316423" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">LIC_CHECK</span></span></span>
 брошен всего лишь один. Он не в состоянии противостоять нашему 
анализатору, просто контролируется и патчится при первой необходимости. 
			<span id="crayon-64eccedc183da943089695" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">VM_EXIT</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">0x1418f3843</span></span></span>. Хендл с макросом 
			<span id="crayon-64eccedc183db483586367" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">_READ_DS_DWORD</span></span></span>, который (кроме всего прочего) прочтет данные из секретной таблицы, равен 
			<span id="crayon-64eccedc183dc909832786" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0x141917511</span></span></span>.</li>
<li>После того как Denuvo соберет и попутно обработает данные со всех 
четырех блоков, будет сформирована матрица лицензии, которая с помощью 
чтения «The Times» каждый раз принимает псевдослучайный вид. Ее можно 
увидеть в стеке по смещению 
			<span id="crayon-64eccedc183dd946122153" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;">+<span class="crayon-cn">0x4A0</span></span></span>, если тормознутся на одном из статических cpuid перед общей проверкой.</li>
<li>Решающая проверка. Если секретная таблица корректна — переходим на вызов WinAPI 
			<span id="crayon-64eccedc183de833003937" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">VirtualAlloc</span></span></span> и далее OEP. Если нет — после некоторых телодвижений вызовем WinAPI 
			<span id="crayon-64eccedc183e0090239684" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">DeleteFileA</span></span></span> для несостоявшейся лицухи. Забавный момент: перед тем как удалить лицуху, Denuvo вызывает этот WinAPI с аргументом 
			<span id="crayon-64eccedc183e1708660152" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span></span></span>, то есть натурально пытается удалить диск 
			<span id="crayon-64eccedc183e2287279762" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">C</span><span class="crayon-sy">:</span></span></span>. Конечно, возвращается ошибка и ничего в итоге не удаляется, но осадочек от такого поворота остается.</li>
<li>Не спеши в OEP, держись за клаву и читай пункт № 7.</li>
<li>Не дыши! Перейди по следующим адресам в отладчике: 
			<span id="crayon-64eccedc183e3391950470" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0x141A2D850</span></span></span> (
			<span id="crayon-64eccedc183e4586192418" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">lic_byte_</span><span class="crayon-p">#1</span></span></span>) и 
			<span id="crayon-64eccedc183e6265138234" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0x141445410</span></span></span> (
			<span id="crayon-64eccedc183e7645362656" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">lic_byte_</span><span class="crayon-p">#2</span></span></span>). Обрати внимание на их значения и сверь их с таблицей.</li>
</ol>
<p><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-4.png" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" loading="lazy" class="aligncenter size-full wp-image-8005" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-4.png" alt="denuvo crack" width="1192" height="871" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-4.png 1192w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-4-768x561.png 768w" sizes="(max-width: 1192px) 100vw, 1192px"><meta itemprop="width" content="1192"><meta itemprop="height" content="871"></span></a></p>
<p>Теперь можно выдохнуть и постараться перейти на ровное дыхание. Все, 
что было написано выше, — ключ, которым хакеры открывают алгоритм 
проверки лицензии Denuvo, накрытый VMProtect!</p>
<p>Таблица значений 
			<span id="crayon-64eccedc183e8812887498" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">LIC_BYTE</span></span></span>
 — маленькая сенсация! — это скрытые отладочные байты, которые Denuvo 
Software Solutiong хранит от посторонних глаз под толстым слоем 
VMProtect. Вот оно: два байта, которые перевесят все остальные 100 Мбайт
 распакованного кода Unravel! 214 двойных слов секретной таблицы и два 
			<span id="crayon-64eccedc183e9936359603" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">LIC_BYTE</span></span></span> можно рассматривать как начало и конец графа.</p>
<p>Даже если эпично наплевать на VMProtect и слова Блауковича «вы 
никогда не узнаете алгоритм проверки», как минимум можно получить 
привязку байтов в секретной таблице к четырем блокам 
			<span id="crayon-64eccedc183ed066379923" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">HWID</span></span></span> (
			<span id="crayon-64eccedc183ef052546163" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">CPUID</span></span></span>, 
			<span id="crayon-64eccedc183f0878655508" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">KUSER_SHARED_DATA</span></span></span>, 
			<span id="crayon-64eccedc183f1288280767" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">IMAGE_DATA_DIRECTORY</span></span></span>, 
			<span id="crayon-64eccedc183f3967994327" class="crayon-syntax crayon-syntax-inline crayon-syntax-inline-nowrap crayon-theme-idle crayon-theme-idle-inline crayon-font-courier-new" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important;"><span class="crayon-pre crayon-code" style="font-size: 15px !important; line-height: 20px !important;font-size: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-i">PEB</span></span></span>).</p>
<p>Если набраться смелости и девиртуализировать всего лишь один контекст
 VMProtect 2 — небольшой реверс алгоритма, состоящего из примитивных 
операций ADD/SUB/SHR (на самом деле он сравнительно короткий, а 
кажущаяся толстота проверки лицензии — всего лишь фейковые операции 
копирования и проверки), сокрушит «неломаемую™» Denuvo кейгеном.</p>
<figure id="attachment_8006" aria-describedby="caption-attachment-8006" style="width: 2342px" class="wp-caption aligncenter"><a href="https://tech-geek.ru/wp-content/uploads/cracking-denuvo-5.png" data-wpel-link="internal"><span itemprop="image" itemscope="" itemtype="https://schema.org/ImageObject"><img itemprop="url image" decoding="async" loading="lazy" class="size-full wp-image-8006" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-5.png" alt="Подлинная часть исходного кода Denuvo 5.0, полученная от третьей стороны — Gate.h и Gate.cpp. Используется для генерации «псевдовиртуальной машины»" width="2342" height="944" srcset="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-5.png 2342w, %D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/cracking-denuvo-5-768x310.png 768w" sizes="(max-width: 2342px) 100vw, 2342px"><meta itemprop="width" content="2342"><meta itemprop="height" content="944"></span></a><figcaption id="caption-attachment-8006" class="wp-caption-text">Подлинная
 часть исходного кода Denuvo 5.0, полученная от третьей стороны — Gate.h
 и Gate.cpp. Используется для генерации «псевдовиртуальной машины»</figcaption></figure>

<p>2014, 2015, 2016, 2017, 2018, 2019… Спустя столько времени эта статья
 обрела свою форму на страницах сайта. Мне остается только поблагодарить
 коллектив этого сайта и следующих завсегдатаев exelab, чья помощь была 
неоценима: OnLyOnE, Archer, reversecode, Nightshade, mak и все 
остальные, кого не перечислил. Удачи в вашей борьбе против DRM и до 
новых встреч на страницах сайта!</p><div class="b-r b-r--after-article"><script async="" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/adsbygoogle.js"></script>
<!-- techgeekru middle adaptive -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5859973253765166" data-ad-slot="1066592675" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div><div id="post-ratings-7994-loading" class="post-ratings-loading"><img src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/loading.gif" width="16" height="16" class="post-ratings-image"> Загрузка...</div>	</div><!-- .entry-content -->
</article><!-- #post-## -->









    



    <meta itemprop="datePublished" content="2019-04-19T14:44:59+02:00">
<meta itemscope="" itemprop="mainEntityOfPage" itemtype="https://schema.org/WebPage" itemid="https://tech-geek.ru/cracking-denuvo/" content="Взлом защиты Denuvo">
<meta itemprop="dateModified" content="2019-10-08">
<meta itemprop="datePublished" content="2019-04-19T14:44:59+02:00">
<div itemprop="publisher" itemscope="" itemtype="https://schema.org/Organization"><meta itemprop="name" content="TECH GEEK"><meta itemprop="telephone" content="TECH GEEK"><meta itemprop="address" content="https://tech-geek.ru"></div><div class="b-related"></div>
<!-- #comments -->
		</main><!-- #main -->
	</div><!-- #primary -->

</div><!-- micro -->



<aside id="secondary" class="widget-area" itemscope="" itemtype="http://schema.org/WPSideBar">

    
	<div style="position: static; margin-bottom: 35px; transition: all 0s ease 0s; transform: none; margin-top: 0px; padding: 0px; width: 300px; top: auto; display: none; height: 0px;"></div><div style="position: static; margin-bottom: 35px; transition: all 0s ease 0s; transform: none; margin-top: 0px; padding: 0px; width: 300px; top: auto; display: none; height: 0px;"></div><div id="custom_html-2" class="widget_text widget widget_custom_html FixedWidget__fixed_widget" style="position: static; margin-bottom: 35px; transition: all 0s ease 0s; transform: none; margin-top: 0px; padding: 0px; width: 300px; top: auto; height: 0px;"><div class="textwidget custom-html-widget"><script async="" src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/adsbygoogle.js"></script>
<!-- techgeekru widget -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5859973253765166" data-ad-slot="1281963054" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div></div>
    
</aside><!-- #secondary -->


	</div><!-- #content -->

    
    
        <div class="footer-navigation container" itemscope="" itemtype="http://schema.org/SiteNavigationElement">
        <div class="main-navigation-inner ">
            <div class="menu-bottom-menu-container"></div>        </div>
    </div>



    <!-- .site-footer -->


            <button type="button" class="scrolltop js-scrolltop" data-mob="on" style="display: none;"></button>
    

</div><!-- #page -->


<link rel="stylesheet" id="crayon-css" href="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/crayon.min.css" media="all">
<script type="text/javascript" id="wp-postratings-js-extra">
/* <![CDATA[ */
var ratingsL10n = {"plugin_url":"https:\/\/tech-geek.ru\/wp-content\/plugins\/wp-postratings","ajax_url":"https:\/\/tech-geek.ru\/wp-admin\/admin-ajax.php","text_wait":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043d\u0435 \u0433\u043e\u043b\u043e\u0441\u0443\u0439\u0442\u0435 \u0437\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e.","image":"stars_crystal","image_ext":"gif","max":"5","show_loading":"1","show_fading":"1","custom":"0"};
var ratings_mouseover_image=new Image();ratings_mouseover_image.src="https://tech-geek.ru/wp-content/plugins/wp-postratings/images/stars_crystal/rating_over.gif";;
/* ]]> */
</script>
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/postratings-js.js" id="wp-postratings-js"></script>
<script type="text/javascript" id="root-scripts-js-extra">
/* <![CDATA[ */
var settings_array = {"rating_text_average":"\u0441\u0440\u0435\u0434\u043d\u0435\u0435","rating_text_from":"\u0438\u0437","lightbox_enabled":""};
var wps_ajax = {"url":"https:\/\/tech-geek.ru\/wp-admin\/admin-ajax.php","nonce":"7b81392898"};
/* ]]> */
</script>
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/scripts.min.js" id="root-scripts-js"></script>
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/comment-reply.min.js" id="comment-reply-js"></script>
<script type="text/javascript" id="q2w3_fixed_widget-js-extra">
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"sidebar-1","use_sticky_position":false,"margin_top":10,"margin_bottom":250,"stop_elements_selectors":"","screen_max_width":0,"screen_max_height":0,"widgets":["#custom_html-2"]}];
/* ]]> */
</script>
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/frontend.min.js" id="q2w3_fixed_widget-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/tech-geek.ru\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="%D0%97%D0%B0%D1%89%D0%B8%D1%82%D0%B0%20%D0%B8%20%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC%20Denuvo_files/crayon.min.js" id="crayon_js-js"></script>



</body></html>